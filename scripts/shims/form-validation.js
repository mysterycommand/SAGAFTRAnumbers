webshims.register("form-validation",function(e,t,i,r,n,s){var a="webkitURL"in i,o=a&&Modernizr.formvalidation&&!t.bugs.bustedValidity,l=o&&parseFloat((navigator.userAgent.match(/Safari\/([\d\.]+)/)||["","999999"])[1],10),d="user-error",u="user-success",c={checkbox:1,radio:1},p=e([]),f=function(){return!e.prop(this,"form")},v=function(t){t=e(t);var i,n,s=p;return"radio"==t[0].type&&(n=t.prop("form"),i=t[0].name,s=i?n?e(n).jProp(i):e(r.getElementsByName(i)).filter(f):t,s=s.filter('[type="radio"]')),s},m=function(t,i){var r;return e.each(t,function(t,s){return s?(r=t+e.prop(i,"validationMessage"),!1):n}),r},h=function(e){var t;try{t=r.activeElement.name===e}catch(i){}return t},g={radio:1,checkbox:1,"select-one":1,"select-multiple":1,file:1,date:1,month:1,week:1,text:1},y={time:1,date:1,month:1,datetime:1,week:1,"datetime-local":1},w=function(i){var r,n,s,a;if(i.target&&(r=e(i.target).getNativeElement()[0],s=e(r).getShadowElement(),"submit"!=r.type&&e.prop(r,"willValidate")&&("change"!=i.type||g[a=s.prop("type")]))){n=e.data(r,"webshimsswitchvalidityclass");var p=function(){if(a||(a=s.prop("type")),!(o&&("change"==i.type||537.36>l)&&y[a]&&e(i.target).is(":focus")||"focusout"==i.type&&"radio"==r.type&&h(r.name))){var n,p,f,g,w,b=e.prop(r,"validity");t.refreshCustomValidityRules&&t.refreshCustomValidityRules(r),b.valid?s.hasClass(u)||(n=u,p=d,g="changedvaliditystate",f="changedvalid",c[r.type]&&r.checked&&v(r).not(r).removeClass(p).addClass(n).removeAttr("aria-invalid"),s.removeAttr("aria-invalid"),e.removeData(r,"webshimsinvalidcause")):(w=m(b,r),e.data(r,"webshimsinvalidcause")!=w&&(e.data(r,"webshimsinvalidcause",w),g="changedvaliditystate"),s.hasClass(d)||(n=d,p=u,c[r.type]&&!r.checked&&v(r).not(r).removeClass(p).addClass(n).attr("aria-invalid","true"),s.attr("aria-invalid","true"),f="changedinvalid")),n&&(s.addClass(n).removeClass(p),setTimeout(function(){e(r).trigger(f)},0)),g&&setTimeout(function(){e(r).trigger(g)},0),e.removeData(r,"webshimsswitchvalidityclass")}};n&&clearTimeout(n),"refreshvalidityui"==i.type?p():e.data(r,"webshimsswitchvalidityclass",setTimeout(p,9))}};e(r.body).on(s.validityUIEvents||"focusout change refreshvalidityui invalid",w).on("reset resetvalui",function(t){var i=e(t.target);"reset"==t.type&&(i=i.filter("form").jProp("elements")),i.filter(".user-error, .user-success").removeAttr("aria-invalid").removeClass("user-error").removeClass("user-success").getNativeElement().each(function(){e.removeData(this,"webshimsinvalidcause")}).trigger("resetvalidityui")});var b=function(){t.scrollRoot=a||"BackCompat"==r.compatMode?e(r.body):e(r.documentElement)},E=Modernizr.boxSizing||Modernizr["display-table"]||e.support.getSetAttribute?"minWidth":"width",V="transitionDelay"in r.documentElement.style;b(),t.ready("DOM",b),t.getRelOffset=function(t,i){t=e(t);var r,n=e(i).offset();return e.swap(e(t)[0],{visibility:"hidden",display:"inline-block",left:0,top:0},function(){r=t.offset()}),n.top-=r.top,n.left-=r.left,n},e.extend(t.wsPopover,{isInElement:function(t,i){return t==i||e.contains(t,i)},show:function(t){var n=e.Event("wspopoverbeforeshow");if(this.element.trigger(n),!n.isDefaultPrevented()&&!this.isVisible){this.isVisible=!0,t=e(t||this.options.prepareFor).getNativeElement();var s=this,a=e(t).getShadowElement();this.clear(),this.element.removeClass("ws-po-visible").css("display","none"),this.prepareFor(t,a),this.position(a),s.timers.show=setTimeout(function(){s.element.css("display",""),s.timers.show=setTimeout(function(){s.element.addClass("ws-po-visible").trigger("wspopovershow")},9)},9),this.element.on("remove",function(e){e.originalEvent||s.destroy()}),e(r).on("focusin"+this.eventns+" mousedown"+this.eventns,function(e){!s.options.hideOnBlur||s.stopBlur||s.isInElement(s.lastElement[0]||r.body,e.target)||s.isInElement(t[0]||r.body,e.target)||s.isInElement(s.element[0],e.target)||s.hide()}),e(i).on("resize"+this.eventns+" pospopover"+this.eventns,function(){clearTimeout(s.timers.repos),s.timers.repos=setTimeout(function(){s.position(a)},900)})}},prepareFor:function(t,i){var r,n=e.extend({},this.options,e(t.prop("form")||[]).data("wspopover")||{},t.data("wspopover")),s=this,a={};this.lastElement=e(t).getShadowFocusElement(),this.prepared&&this.options.prepareFor||("element"==n.appendTo?this.element.insertAfter(t):this.element.appendTo(n.appendTo)),this.element.attr({"data-class":t.prop("className"),"data-id":t.prop("id")}),a[E]=n.constrainWidth?i.outerWidth():"",this.element.css(a),n.hideOnBlur&&(r=function(e){s.stopBlur?e.stopImmediatePropagation():s.hide()},s.timers.bindBlur=setTimeout(function(){s.lastElement.off(s.eventns).on("focusout"+s.eventns+" blur"+s.eventns,r),s.lastElement.getNativeElement().off(s.eventns)},10)),!this.prepared&&e.fn.bgIframe&&this.element.bgIframe(),this.prepared=!0},clear:function(){e(i).off(this.eventns),e(r).off(this.eventns),this.element.off("transitionend"+this.eventns),this.stopBlur=!1,e.each(this.timers,function(e,t){clearTimeout(t)})},hide:function(){var t=e.Event("wspopoverbeforehide");if(this.element.trigger(t),!t.isDefaultPrevented()&&this.isVisible){this.isVisible=!1;var r=this,n=function(t){t&&"transitionend"==t.type&&(t=t.originalEvent)&&t.target==r.element[0]&&"hidden"==r.element.css("visibility")||(r.element.off("transitionend"+r.eventns).css("display","none").attr({"data-id":"","data-class":"",hidden:"hidden"}),clearTimeout(r.timers.forcehide),e(i).off("resize"+r.eventns))};this.clear(),this.element.removeClass("ws-po-visible").trigger("wspopoverhide"),e(i).on("resize"+this.eventns,n),V&&this.element.off("transitionend"+this.eventns).on("transitionend"+this.eventns,n),r.timers.forcehide=setTimeout(n,V?600:40)}},position:function(e){var i=t.getRelOffset(this.element.css({marginTop:0,marginLeft:0,marginRight:0,marginBottom:0}).removeAttr("hidden"),e);i.top+=e.outerHeight(),this.element.css({marginTop:"",marginLeft:"",marginRight:"",marginBottom:""}).css(i)}}),t.validityAlert=function(){var r=t.objectCreate(t.wsPopover,{},s.messagePopover),n=r.hide.bind(r);return r.element.addClass("validity-alert").attr({role:"alert"}),e.extend(r,{hideDelay:5e3,showFor:function(t,i,r,s){t=e(t).getNativeElement(),this.clear(),this.hide(),s||(this.getMessage(t,i),this.show(t),this.hideDelay&&(this.timers.delayedHide=setTimeout(n,this.hideDelay))),r||this.setFocus(t)},setFocus:function(r){var n=e(r).getShadowFocusElement(),s=t.scrollRoot.scrollTop(),a=n.offset().top-30,o=function(){try{n[0].focus()}catch(t){}e(i).triggerHandler("pospopover"+this.eventns)};s>a?t.scrollRoot.animate({scrollTop:a-5},{queue:!1,duration:Math.max(Math.min(600,1.5*(s-a)),80),complete:o}):o()},getMessage:function(e,t){t||(t=e.getErrorMessage()),t?r.contentElement.text(t):this.hide()}}),r}();var x={slide:{show:"slideDown",hide:"slideUp"},fade:{show:"fadeIn",hide:"fadeOut"}};x[s.iVal.fx]||(s.iVal.fx="slide"),t.errorbox={create:function(t,i){i||(i=this.getFieldWrapper(t));var r=e("div.ws-errorbox",i);return r.length||(r=e('<div class="ws-errorbox" hidden="hidden">'),i.append(r)),i.data("errorbox",r),r},getFieldWrapper:function(i){var r;return s.iVal.fieldWrapper&&(r="function"==typeof s.iVal.fieldWrapper?s.iVal.fieldWrapper.apply(this,arguments):e(i).parent().closest(s.iVal.fieldWrapper),r.length||(r=!1,t.error("could not find fieldwrapper: "+s.iVal.fieldWrapper))),r||(r=e(i).parent().closest(":not(span, label, em, strong, b, mark, p)")),r},get:function(t,i){i||(i=this.getFieldWrapper(t));var r=i.data("errorbox");return r?"string"==typeof r&&(r=e("#"+r),e.data(t,"errorbox",r)):r=this.create(t,i),r},addSuccess:function(t,i){var r=e.prop(t,"type"),n=function(){var n=c[r]?e.prop(t,"checked"):e(t).val();i[n?"addClass":"removeClass"]("ws-success")},s=g[r]?"change":"blur";e(t).off(".recheckvalid").on(s+".recheckinvalid",n),n()},hideError:function(t,i){var r=this.getFieldWrapper(t),n=r.data("errorbox");return n&&n.jquery&&(r.removeClass("ws-invalid"),n.message="",e(t).filter("input").off(".recheckinvalid"),n.slideUp(function(){e(this).attr({hidden:"hidden"})})),i||this.addSuccess(t,r),r},recheckInvalidInput:function(t){if(s.iVal.recheckDelay&&s.iVal.recheckDelay>90){var i,r=function(){w({type:"input",target:t})};e(t).filter('input:not([type="checkbox"], [type="radio"])').off(".recheckinvalid").on("input.recheckinvalid",function(){clearTimeout(i),i=setTimeout(r,s.iVal.recheckDelay)})}},showError:function(t,i){var r=this.getFieldWrapper(t),n=this.get(t,r);return n.message!=i&&(n.stop(!0,!0).html("<p>"+i+"</p>"),n.message=i,r.addClass("ws-invalid").removeClass("ws-success"),n.is("[hidden]")&&(this.recheckInvalidInput(t),n.css({display:"none"}).removeAttr("hidden")[x[s.iVal.fx].show]())),r.removeClass("ws-success"),e(t).off(".recheckvalid"),r},reset:function(e){this.hideError(e,!0).removeClass("ws-success")},toggle:function(t){var i=e(t).getErrorMessage();i?this.showError(t,i):this.hideError(t,i)}},e(r.body).on({changedvaliditystate:function(i){if(s.iVal.sel){var r=e(i.target).jProp("form");r.is(s.iVal.sel)&&t.errorbox.toggle(i.target)}},resetvalidityui:function(i){if(s.iVal.sel){var r=e(i.target).jProp("form");r.is(s.iVal.sel)&&t.errorbox.reset(i.target)}},firstinvalid:function(i){if(s.iVal.sel&&s.iVal.handleBubble){var r=e(i.target).jProp("form");r.is(s.iVal.sel)&&(i.preventDefault(),"none"!=s.iVal.handleBubble&&t.validityAlert.showFor(i.target,!1,!1,"hide"==s.iVal.handleBubble))}},submit:function(t){return s.iVal.sel&&e(t.target).is(s.iVal.sel)&&e.prop(t.target,"noValidate")&&!e(t.target).checkValidity()?!1:n}}),t.modules["form-core"].getGroupElements=v,o&&540>l&&function(){var t=/^(?:textarea|input)$/i,n=!1;r.addEventListener("contextmenu",function(e){t.test(e.target.nodeName||"")&&(n=e.target.form)&&setTimeout(function(){n=!1},1)},!1),e(i).on("invalid",function(e){e.originalEvent&&n&&n==e.target.form&&(e.wrongWebkitInvalid=!0,e.stopImmediatePropagation())})}()});